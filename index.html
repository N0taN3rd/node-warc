<html>
<head>
<script src="dist/nodewarc.js"></script>
<script>
function parseWARC(files) {
    let reader = new FileReader();

    reader.onloadend = function() {
        var rstream = new stream.Readable();
        rstream._read = () => {};
        rstream.push(new Uint8Array(reader.result));
        rstream.push(null);

        // attempt to set large window to avoid error
        var gunzip = rstream.pipe(zlib.createGunzip({chunkSize: 1024*1024*16, windowBits: 15, flush: zlib.Z_NO_FLUSH, finishFlush: zlib.Z_SYNC_FLUSH}));

        const parser = new WARCParser(gunzip);
        parser.on('record', record => { console.log(record) })
        parser.on('done', () => { console.log('finished') })
        parser.on('error', error => { console.error(error) })
        parser.start()
    }

    reader.readAsArrayBuffer(files[0]);
}
</script>
</head>
<body>

        <span>
                Test WARC:
                <input id="file-input" type="file" name="file-input" onchange="parseWARC(this.files)" style="display: none;" />
                <input id="coll-name" type="text" value="replay" name="coll-name"/>
                <button onclick="document.getElementById('file-input').click();">Open WARC File</button>
        </span>
</body>
</html>
